{"version":3,"sources":["index.js"],"names":["incoming","storyText","padding","cnv","saveButton","refreshButton","readmeButton","prompt","test","choices","chindex","frindex","isLoading","isKeyPressed","isTesting","isGlitching","preload","getAICompletion","createImg","attribute","class","mousePressed","save","location","reload","open","forEach","btn","hide","setup","createCanvas","windowWidth","windowHeight","draw","push","fill","textSize","textAlign","CENTER","translate","width","height","text","pop","random","background","clear","pWidth","pHeight","story","replace","textWrap","WORD","textFont","LEFT","BOTTOM","substring","length","drawGlitch","frameRate","noLoop","btnX","position","show","getChoices","setTimeout","clearTimeout","fetch","method","headers","Authorization","body","JSON","stringify","model","max_tokens","temperature","top_p","frequency_penalty","presence_penalty","best_of","echo","logprobs","then","r","json","d","_text","windowResized","resizeCanvas","keyPressed","newPrompt","cboices","keyCode","alert","inText","spl","split","i","print","sq","stroke","rect"],"mappings":"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","file":"src.6c3568d5.js","sourceRoot":"../src","sourcesContent":["let prompt = \"write a text-based horror adventure prompt, with 2-3 choices numbered\";\nlet test = `write a text-based horror adventure prompt, with 2-3 choices numbered\n\nYou wake up in a strange room with no windows and one door. \n\n\t1\tExamine the room for clues\n2. Try the door\n3. Scream for help\n\nTry the door\nYou cautiously approach the door and reach for the handle. The door is locked. \n\n\t1\tLook for a key\n2. Try to break down the door\n3. Scream for help\n\nScream for help\nYou call out for help, but the only response is a deep, menacing laugh from somewhere in the room. \n\n\t1\tHide\n2. Search the room for the source of the laugh\n3. Try to break down the door\n\nSearch the room for the source of the laugh\nYou slowly move around the room, searching for the source of the laugh. You finally find it: a tall figure in a dark cloak standing in the corner of the room. \n\n\t1\tRun for the door\n2. Talk to the figure\n3. Attack the figure\n\nScream for help\nYou call out for help, but the only response is a deep, menacing laugh from somewhere in the room. \n\n\t1\tHide\n2. Search the room for the source of the laugh\n3. Try to break down the door\n\nSearch the room for the source of the laugh\nYou slowly move around the room, searching for the source of the laugh. You finally find it: a tall figure in a dark cloak standing in the corner of the room. \n`;\nlet choices = {};\nlet incoming;\nlet storyText;\nlet chindex = 1;\nlet frindex = 30;\nlet padding;\nlet isLoading = true;\nlet isKeyPressed = false;\nlet isTesting = false;\nlet isGlitching = 7;\nlet cnv;\nlet saveButton, refreshButton, readmeButton;\n\nfunction preload() {\n    getAICompletion();\n    // Windows icons from https://win98icons.alexmeub.com/\n    saveButton = createImg(\"https://win98icons.alexmeub.com/icons/png/printer-0.png\", \"printer icon\");\n    saveButton.attribute(\"title\", \"Click to save adventure as image file.\");\n    saveButton.class(\"ninetyfive-button\");\n    saveButton.mousePressed(() => {\n        save(cnv, 'ai-loves-horror-portrait.jpg');\n    });\n\n    refreshButton = createImg(\"https://win98icons.alexmeub.com/icons/png/netmeeting-0.png\", \"refresh icon\");\n    refreshButton.attribute(\"title\", \"Click to replay.\");\n    refreshButton.class(\"ninetyfive-button\");\n    refreshButton.mousePressed(() => {\n        location.reload();\n    });\n\n    readmeButton = createImg(\"https://win98icons.alexmeub.com/icons/png/file_question.png\", \"readme icon\");\n    readmeButton.attribute(\"title\", \"Click to read more about this project.\");\n    readmeButton.class(\"ninetyfive-button\");\n    readmeButton.mousePressed(() => {\n        open(\"https://raw.githubusercontent.com/iguannalin/ai-loves-horror/main/README.md\");\n    });\n\n    [saveButton, refreshButton, readmeButton].forEach((btn) => { btn.hide(); });\n}\n\nfunction setup() {\n    cnv = createCanvas(windowWidth, windowHeight);\n}\n\nfunction draw() {\n    if (!storyText || isLoading) {\n        push();\n            fill('#FFC107');\n            textSize(16);\n            textAlign(CENTER);\n            translate(width/2, height - 50);\n            text(\"Loading...\", 0, 0);\n        pop();\n        return;\n    }\n    if (random() > 0.75) {\n        background(255, 255, 255, 0.3);\n    } else {\n        clear();\n    }\n    fill('green');\n    let padding = width / 5;\n    let pWidth = width - padding;\n    let pHeight = height - padding;\n    let story = storyText.replace(prompt, \"Type 1, 2, or 3 on the keyboard to continue the story.\");\n    textWrap(WORD);\n    textFont(\"Times New Roman\");\n    textSize(20);\n    textAlign(LEFT, BOTTOM);\n    text(story.substring(0, chindex), 60, 0, width > 600 ? pWidth : width - 60, pHeight);\n    if (chindex < story.length) {\n        chindex++;\n        drawGlitch();\n        frameRate(random(20, frindex += 0.2));\n    }\n    if (!choices || isTesting) {\n        push();\n            fill('#FFC107');\n            textSize(16);\n            textAlign(CENTER);\n            translate(width/2, height - 50);\n            text(\"\\nThere are no choices left.\", 0, 0);\n            if (!isTesting) noLoop();\n        pop();\n        let btnX = 150;\n        [saveButton, refreshButton, readmeButton].forEach((btn) => {\n            btn.position((width/2) + btnX, height - 70);\n            btnX += 60;\n            btn.show();\n        });\n    }\n    // frameRate(100);\n}\n\nfunction getAICompletion() {\n    isLoading = true;\n    if (isTesting) {\n        incoming = test;\n        getChoices(storyText ? incoming.substring(storyText.length) : incoming); // get choices from most recent text\n        storyText = incoming;\n        setTimeout(() => {\n            isLoading = false;\n            clearTimeout();\n        }, 500);\n        return;\n    }\n    fetch(\"https://api.openai.com/v1/completions\", {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization:\n                \"Bearer sess-QTLLs1UOLM752lCXVsLd1NSKrYaWeBtTuumGl5Ux\",\n        },\n        body: JSON.stringify({\n            model: \"text-davinci-003\",\n            prompt: (storyText ? storyText : prompt),\n            max_tokens: 256,\n            temperature: 0.7,\n            top_p: 1,\n            frequency_penalty: 0,\n            presence_penalty: 0,\n            best_of: 1,\n            echo: true,\n            logprobs: 0\n        }),\n    })\n        .then((r) => r.json())\n        .then((d) => {\n            let _text = d.choices[0].text;\n            incoming = storyText ? _text.substring(storyText.length) : _text;\n            getChoices(incoming); // get choices from most recent text\n            storyText = _text;\n            isLoading = false;\n            isKeyPressed = false;\n            // print({ storyText });\n        });\n}\n\nfunction windowResized() {\n    resizeCanvas(windowWidth, windowHeight);\n}\n\nfunction keyPressed() {\n    let newPrompt;\n    if (isKeyPressed) return;\n    isKeyPressed = true;\n    cboices = {};\n    switch (keyCode) {\n        case 49:\n            if (choices[1]) newPrompt = choices[1];\n            break;\n        case 50:\n            if (choices[2]) newPrompt = choices[2];\n            break;\n        case 51:\n            if (choices[3]) newPrompt = choices[3];\n            else alert(\"please choose a valid choice\");\n            break;\n        default:\n            break;\n    }\n    // print(prompt);\n    if (newPrompt) {\n        storyText += \"\\n\\n\" + newPrompt + \"\\n\";\n        push();\n            fill('#FFC107');\n            textSize(16);\n            textAlign(CENTER);\n            translate(width/2, height - 75);\n            text(newPrompt, 0, 0);\n        pop();\n        getAICompletion();\n    }\n}\n\nfunction getChoices(inText) {\n    if (!inText) return;\n    let spl = inText.split(/\\n[1-3][.]*/g);\n    for (let i = 1; i < 4; i++) {\n        if (spl[i]) choices[i] = spl[i];\n    }\n    print({ choices });\n}\n\nfunction drawGlitch() {\n    if (random() > 0.998 || isGlitching < 7) {\n        isGlitching = isGlitching === 0 ? 7 : isGlitching - 1;\n        for (let i = 0; i < 75; i++) {\n            let sq = random(5, 11);\n            push();\n            stroke('rgba(163,255,197,0.56)');\n            fill('rgba(158,158,158,0.64)');\n            if (random() > 0.99) fill('rgba(75,75,75,0.55)');\n            rect(random(0, width), random(0, height), sq, sq);\n            pop();\n        }\n    }\n}\n"]}